# ATOMIC-R2-05_DETERMINISM
**일자**: 2026-01-05
**상태**: **완료 (STABLE)**

## 1. 개요
리포트 엔진의 핵심 계산 로직이 확장되거나 변경되어도, 기존 입력에 대한 결과의 일관성(Determinism)을 보장하기 위한 **결정론 해시(Determinism Hash)** 및 **골든 벡터(Golden Vectors)** 체계를 구축했습니다.

## 2. 결정론 해시 (SHA-256)
- **대상**: (정규화된 입력 데이터) + (Pillars 연주/월주/일주/시주) + (대운 방향/시작나이/순서).
- **특징**: 객체의 키를 정렬한 후 직렬화하여 해싱하므로 순서에 따른 해시 변화가 없습니다.
- **용도**: 
  - 엔진 확장 시 회귀 테스트 지표로 활용.
  - 리포트 무결성 증명 (UI 푸터 및 메타데이터에 포함).

## 3. 골든 벡터 (Golden Vectors)
총 10개의 대표 케이스를 선정하여 결정론적 결과를 동결(Frozen)했습니다:
- **GV_001~002**: 표준 양력 남/여.
- **GV_003**: 음력 및 윤달 케이스.
- **GV_004**: 시간 미지정(Time Unknown) 케이스 -> 안정적 디폴트 시간(12:00) 적용.
- **GV_005~007**: 이름 분석(한자, 1자, 혼합 언어) 케이스.
- **GV_008~010**: 과거/미래 연도 및 자정(Midnight) 경계 케이스.

## 4. 검증 정책 (CI Gate)
- 모든 `npm run verify` 시 `functions/test/determinism.test.ts`가 실행됩니다.
- 골든 벡터의 해시가 일치하지 않으면 빌드가 실패하며, 이는 의도치 않은 계산 로직 변경을 방지합니다.

---
**보고자**: 릴리즈/연속성 엔지니어
**판정**: **PASS - 결과 일관성 보증 체계 확립.**
